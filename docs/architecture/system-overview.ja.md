# システム概要

Argodeは、インタラクティブな物語の作成を効率化するために設計された、Godot Engine向けの強力で柔軟なビジュアルノベルフレームワークです。拡張性、開発者の利便性、そしてスクリプト中心のアセット管理アプローチを重視しています。

## コアアーキテクチャ: ArgodeSystem シングルトン

Argodeの中核は、Godotプロジェクトに導入される唯一のグローバルノードである`ArgodeSystem`シングルトンです。この設計により、グローバル名前空間の汚染を最小限に抑え、すべてのフレームワークコンポーネントに対してクリーンで予測可能な構造を提供します。

その他のすべてのコア機能は`ArgodeSystem`の子ノードとして管理され、デバッグと統合を簡素化する明確な階層を形成しています。主要なマネージャーには以下が含まれます。

*   **`ScriptPlayer`**: `.rgd`スクリプトファイルを解析および実行し、物語の流れを駆動します。
*   **`UIManager`**: ユーザーインターフェースシーンの表示と管理を処理します。
*   **`VariableManager`**: 配列や辞書などの複雑なデータ型を含む、すべてのゲーム変数を管理します。

*   **`CharacterManager`**: キャラクターの定義、表情、表示を監督します。
*   **`LayerManager`**: GodotのCanvasLayersに視覚要素をマッピングするための柔軟なシステムを提供し、カスタムシーンレイアウトを可能にします。
*   **`CustomCommandHandler`**: Argodeの強力な拡張性のゲートウェイであり、未知のコマンドをカスタムゲームロジックのシグナルとして転送します。
*   **`LabelRegistry`**: ナビゲーションとフロー制御のために、`.rgd`スクリプト内のラベルをインデックス化および管理します。
*   **`DefinitionLoader`**: `.rgd`ファイル内で宣言されたアセットおよびキャラクター定義を処理します。

## RGDファイルによるスクリプト中心のワークフロー

Argodeは、ゲームロジック、ダイアログ、アセットを定義するために、独自の`.rgd`（Argodeスクリプト）ファイル形式を活用しています。このスクリプト中心のアプローチにより、ライターと開発者は主にプレーンテキストファイルで作業でき、バージョン管理と一括操作が簡素化されます。

RGDファイルの主な機能：

*   **物語の流れ**: ダイアログ、選択肢、シーン遷移を定義します。
*   **アセット定義**: キャラクター、画像、オーディオ、シェーダーをスクリプト内で直接宣言します。
*   **コマンド**: タイミング、UI操作、変数管理のための豊富な組み込みコマンドセットを利用します。
*   **拡張性**: ユーザー定義コマンドを通じてカスタムゲームロジックを簡単に統合できます。

開発エクスペリエンスを向上させるために、専用の[VS Code拡張機能](https://github.com/AheadGameStudio/Argode-rgd-syntax-highlighter)が`.rgd`ファイルの構文ハイライトとIntelliSenseサポートを提供します。

## 予測的なアセット管理

Argodeは、起動時にスクリプト構造全体を分析するインテリジェントなアセット管理システムを組み込んでいます。制御フローグラフを構築することで、到達可能性分析を実行して、どのリソースが必要になるかを予測し、スマートなプリロードとメモリ使用量の最適化を可能にします。これにより、手動での最適化なしに、読み込み時間の短縮とスムーズなプレイヤーエクスペリエンスが保証されます。

## 柔軟なUIとレイヤーシステム

このフレームワークは、`AdvScreen`ノードを中心に構築された高度なUIシステムを提供し、スクリプトとシームレスに統合する複雑でインタラクティブなユーザーインターフェースを可能にします。柔軟な`LayerManager`と組み合わせることで、開発者はカスタムCanvasLayerの役割を定義でき、Argodeを既存のGodotプロジェクトや独自の視覚的要件に適応させることができます。

## 開発エクスペリエンス

迅速なイテレーションのために設計されたArgodeは、スクリプトのホットリロードとゲーム状態のリアルタイム検査をサポートしています。開発者の利便性に焦点を当て、堅牢なエラー検出とIDE統合を組み合わせることで、ビジュアルノベル開発ワークフローを大幅に加速します。

---

[設計思想について学ぶ →](design-philosophy.md){ .md-button }
[コアコンポーネントを見る →](core-components.md){ .md-button }